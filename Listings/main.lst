C51 COMPILER V9.60.0.0   MAIN                                                              03/18/2021 20:25:04 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main
                    -.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "stdio.h"
   2          #include "string.h" 
   3          #include "at89c5131.h"
   4          #include "defs.h"
   5          #include "utils/lcd/lcd.h"
   6          #include "utils/serial/serial.h"
   7          
   8          unsigned int runs, wickets, overs, balls;
   9          unsigned char status[17];
  10          bit new_over = 0;
  11          
  12          void main(void) {
  13   1        unsigned char score[16];
  14   1        unsigned char ch;
  15   1        
  16   1        lcd_init();
  17   1        uart_init();
  18   1        init();
  19   1        
  20   1        // throw away erroneous first character
  21   1        receive_char();
  22   1        
  23   1        while(1) {
  24   2          sprintf(score, "%d/%d (%d.%d)", runs, wickets, overs, balls);
  25   2          
  26   2          lcd_cmd(0x80);
  27   2          lcd_string(score);
  28   2          lcd_cmd(0x0C0);
  29   2          lcd_string(status);
  30   2          
  31   2          if(overs == 20 || wickets == 10){
  32   3            reset();
  33   3            continue;
  34   3          }
  35   2          
  36   2          ch = receive_char();
  37   2          
  38   2          switch(ch) {
  39   3            case '6': runs ++;
  40   3            case '5': runs ++;
  41   3            case '4': runs ++;
  42   3            case '3': runs ++;
  43   3            case '2': runs ++;
  44   3            case '1': runs ++;
  45   3            case '.': balls ++;
  46   3                      break;
  47   3            
  48   3            case 'e': 
  49   3            case 'n': runs ++;
  50   3                      ch -= 32;
  51   3                      break;
  52   3            
  53   3            case 'w': wickets ++;
  54   3                      balls ++;
C51 COMPILER V9.60.0.0   MAIN                                                              03/18/2021 20:25:04 PAGE 2   

  55   3                      ch -= 32;
  56   3                      break;
  57   3            
  58   3            default: transmit_char(ch);
  59   3                     transmit_string(" - Invalid character sent\r\n");
  60   3                     continue;
  61   3          }
  62   2          
  63   2          update(ch);
  64   2        }
  65   1      }
  66          
  67          void init() {
  68   1      /*******************************************************
  69   1        DESC: initialization of global variables and messages
  70   1      *******************************************************/
  71   1        // initial messages
  72   1        transmit_string("*******************************\r\n");
  73   1        transmit_string("********Cricketscore***********\r\n");
  74   1        transmit_string("*******************************\r\n");
  75   1        transmit_string("Press a character to start game\r\n");
  76   1        
  77   1        // global vars
  78   1        runs = 0;
  79   1        wickets = 0, overs = 0, balls = 0;
  80   1        status[0] = 0;
  81   1      }
  82          
  83          void update(unsigned char ch) {
  84   1      /***********************************************************
  85   1        DESC: updation of global variables after a ball is bowled
  86   1        ARGS:
  87   1          ch: character received from keyboard
  88   1      ***********************************************************/
  89   1        if(new_over == 1) {
  90   2          status[0] = 0;
  91   2          lcd_cmd(0x01);
  92   2          msdelay(100);
  93   2          new_over = 0;
  94   2        }
  95   1        
  96   1        if(balls == 6) {
  97   2          balls = 0;
  98   2          overs ++;
  99   2          new_over = 1;
 100   2        }
 101   1        
 102   1        strncat(status, &ch, 1);
 103   1      }
 104          
 105          void reset() {
 106   1      /*************************************************
 107   1        DESC: denote end of innings and reset variables
 108   1      *************************************************/
 109   1        lcd_cmd(0x0C0);
 110   1        lcd_string("Innings Ends");
 111   1        msdelay(5000);
 112   1        lcd_cmd(0x01);
 113   1        msdelay(100);
 114   1        init();
 115   1      }

C51 COMPILER V9.60.0.0   MAIN                                                              03/18/2021 20:25:04 PAGE 3   


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    433    ----
   CONSTANT SIZE    =    157    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     25      18
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
